var d=Object.defineProperty;var m=(n,o,t)=>o in n?d(n,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[o]=t;var i=(n,o,t)=>m(n,typeof o!="symbol"?o+"":o,t);import{R as a,j as e,r as c}from"./index-D3PN5aAM.js";class l extends a.Component{constructor(){super(...arguments);i(this,"state",{arr:[],timeStamp:0,lifeCycleError:!1});i(this,"triggerRenderError",()=>{this.setState({arr:null})});i(this,"triggerLifecycleError",()=>{this.setState({lifeCycleError:!0})})}componentDidUpdate(t,r,s){if(console.log("子组件componentDidUpdate调用",t,r,s),t.count===9||this.state.lifeCycleError)throw new Error("ErrorTrigger error")}render(){return e.jsxs("div",{style:{border:"1px solid #e1e1e1",padding:"20px"},children:[e.jsx("h3",{children:"子组件:this is ErrorTrigger"}),e.jsx("div",{children:this.state.arr.map(t=>t)}),e.jsx("button",{onClick:this.triggerRenderError,children:"触发render错误"}),e.jsx("button",{onClick:this.triggerLifecycleError,style:{marginLeft:"10px"},children:"触发生命周期执行错误"})]})}}class u extends a.Component{constructor(t){super(t);i(this,"increment",()=>{this.setState({count:this.state.count+1})});this.state={count:0,hasError:!1,timestamp:Date.now()}}static getDerivedStateFromProps(t,r){return console.log("getDerivedStateFromProps::",t,r),{timestamp:Date.now()}}componentDidMount(){console.log("componentDidMount::",this.props,this.state)}shouldComponentUpdate(t,r,s){return console.log("shouldComponentUpdate::",t,r,s),!0}getSnapshotBeforeUpdate(t,r){return console.log("getSnapshotBeforeUpdate::",t,r),"componentDidUpdate第三个参数,来自getSnapshotBeforeUpdate周期的返回值"}componentDidUpdate(t,r,s){console.log("componentDidUpdate::",t,r,s)}static getDerivedStateFromError(t){return console.log("getDerivedStateFromError::",t),{hasError:!0}}componentDidCatch(t,r){console.log("componentDidCatch::",t,r)}componentWillUnmount(){console.log("componentWillUnmount::",this.props,this.state)}render(){return console.log("render::",this.props,this.state),this.state.hasError?e.jsx("div",{children:"Error occurred!"}):e.jsxs("div",{children:[e.jsx("h3",{children:"类组件:"}),e.jsxs("h4",{children:["更新执行时间:",this.state.timestamp]}),e.jsxs("div",{children:["props-name:",this.props.name]}),e.jsxs("div",{id:"count",children:["Count:",this.state.count]}),e.jsx("button",{onClick:this.increment,children:"增加count"}),e.jsx(l,{count:this.state.count})]})}}const h=n=>{const[o,t]=c.useState({count:0,hasError:!1,timestamp:Date.now()});c.useEffect(()=>{console.log("getDerivedStateFromProps::",n,o)},[o,n]),c.useEffect(()=>(console.log("componentDidMount::",n,o),()=>{console.log("componentWillUnmount::",n,o)}),[]),c.useEffect(()=>{console.log("componentDidUpdate::",o)},[o]);const r=()=>{t({...o,count:o.count+1,timestamp:Date.now()})};return e.jsxs("div",{children:[e.jsx("h3",{children:"函数组件:"}),e.jsxs("h4",{children:["更新执行时间:",o.timestamp]}),e.jsxs("div",{children:["props-name:",n.name]}),e.jsxs("div",{id:"count",children:["Count:",o.count]}),e.jsx("button",{onClick:r,children:"增加count"}),e.jsx(l,{count:o.count})]})},x=()=>{const[n]=c.useState({name:"jack"});return e.jsxs("div",{children:[e.jsx(u,{name:n.name}),e.jsx(h,{name:n.name})]})};export{x as default};
